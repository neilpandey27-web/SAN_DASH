# SAN Dashboard v2.0 Release Notes

## Release Date
2025-01-XX

## Major Features

### 1. 3-Level Nested Sunburst Charts
- **Hierarchy Sunburst Chart**: Replaced traditional pie chart with interactive 3-level sunburst
  - Layer 1 (Inner): Pools
  - Layer 2 (Middle): Child Pools + Buffer
  - Layer 3 (Outer): Tenants
  - Dynamic pool count support (works with any number of pools)
  - Color-coded by pool family (Red, Blue, Green, Orange)
  - Ancestor highlighting on hover

### 2. Capacity Breakdown Sunburst Chart
- **New capacity visualization** showing Total SAN Capacity breakdown
  - Center: Total SAN Capacity label
  - Layer 1: Available Buffer + Allocated
  - Layer 2: Utilized + Unutilized (with labels)
  - Layer 3: Detail layer (visual enhancement, no labels)
  - Buffer creates visual gap at outer layers

### 3. Individual Pool Sunburst Charts
- **Dynamic grid of individual pool charts**
  - One chart per pool (4 charts for 4 pools, scales dynamically)
  - 2-layer structure: Child Pools → Tenants
  - Responsive grid layout (2 columns for 4+ pools)
  - Pool name in title
  - Buffer child pools create visual gap (no tenant layer)

### 4. Reorganized Dashboard Layout
**New 4-Layer Structure**:
1. **Layer 1**: Summary Table (full width)
2. **Layer 2**: Capacity Sunburst + Top 10 Bar Chart (side by side)
3. **Layer 3**: Individual Pool Sunburst Charts (dynamic grid)
4. **Layer 4**: Detail Table (full width)

**Benefits**:
- Summary metrics immediately visible at top
- Capacity analytics (breakdown + top consumers) prominently displayed
- Individual pool details in organized grid
- Drill-down table remains at bottom for detailed exploration

## Technical Improvements

### Frontend (`Dashboard.js`)
1. **New Chart Functions**:
   - `getCapacitySunburstOption()` - Capacity breakdown sunburst
   - `getIndividualPoolSunburstOptions()` - Array of individual pool charts
   - `generateColorShades()` - Dynamic color gradient generation

2. **Enhanced Color Schemes**:
   - Sunburst color families for pools (Red, Blue, Green, Orange)
   - Hierarchical color shading (dark → medium → light)
   - Capacity chart color scheme (Gray for buffer, Blue family for allocated)

3. **Chart Configuration**:
   - Ancestor highlighting with `focus: 'ancestor'`
   - Enhanced emphasis effects (shadow, border)
   - Dynamic label positioning and sizing
   - Responsive grid layout for multiple charts

### Backend (`views.py`)
1. **Hierarchical Data Structure**:
   - New `sunburst_data` field in pools level API response
   - Nested structure: Pool → Child Pool → Tenant
   - Buffer calculation per pool
   - Empty children arrays for Buffer segments

2. **Data Processing**:
   - Dynamic tenant extraction from volume names
   - Lab Engineering filtering maintained
   - Buffer capacity calculation (Pool Total - Sum of Child Pools)

## Visual Enhancements

### Chart Heights
- Capacity sunburst: 700px
- Individual pool sunbursts: 500px
- Bar chart: 700px (increased from 400px)

### Tooltips
- All charts show capacity in both TB and GB
- Percentage calculations for capacity breakdown
- Formatted numbers with thousands separators

### Labels
- All 3 layers of sunburst charts show labels
- Font sizes optimized per layer (14px → 12px → 10px)
- White text with black border for visibility
- Detail layers hide labels for clean appearance

## Data Flow

### Capacity Breakdown
```
Total SAN Capacity (8,000.00 TB)
├─ Available Buffer (805.50 TB) [stops at Layer 1]
└─ Allocated (7,194.50 TB)
   ├─ Utilized (4,500.00 TB) → Detail Layer
   └─ Unutilized (2,694.50 TB) → Detail Layer
```

### Hierarchy Breakdown (Per Pool)
```
Pool (e.g., AIX-Pool)
├─ Child Pool 1
│  ├─ Tenant A
│  ├─ Tenant B
│  └─ Tenant C
├─ Child Pool 2
│  ├─ Tenant D
│  └─ Tenant E
└─ Buffer [no tenant layer - creates visual gap]
```

## Breaking Changes
None - All existing functionality maintained.

## Upgrade Notes
- Frontend component completely restructured
- Backend API response includes new `sunburst_data` field
- No database changes required
- Backward compatible with v1.0 data

## Bug Fixes
- Fixed Available Buffer calculation (v1.0 issue with 'nan' values)
- Proper handling of empty child_pool values from Excel
- Correct filtering of Lab Engineering pools

## Performance
- SVG rendering for all charts (smooth performance)
- Efficient color generation algorithms
- Optimized label collision detection

## Browser Compatibility
- Chrome/Edge: Full support
- Firefox: Full support
- Safari: Full support
- Mobile browsers: Responsive layout supported

## Known Limitations
- Maximum recommended pools: 12 (for optimal grid display)
- Chart heights fixed (not dynamically adjustable)
- Print layout may require custom CSS

## Future Enhancements (v2.1+)
- Drill-down click interaction on sunburst segments
- Export chart images functionality
- Customizable color themes
- Animation transitions between views
- Mobile-optimized touch interactions

## Migration from v1.0
1. Pull latest code from v2.0-branch
2. Run `npm install` (no new dependencies)
3. Restart frontend: `pm2 restart webapp`
4. No database migrations required

## Credits
- Developed for SAN capacity management and visualization
- Built with React 18, ECharts 5.x, IBM Carbon Design System
- Backend: Django REST Framework with PostgreSQL

---

**Version**: 2.0  
**Release Branch**: v2.0-branch  
**Previous Version**: v1.0-branch
